//make map icons

mapIcons = {
    "factory": "https://lh3.googleusercontent.com/s0u2dJBrTKgYThe_Felbrv1g8rwakop7YMkHNIMdHIyuCIQHb24IhU_spWbAHnsNl3g867qSClZXIo-DMKPuzB6uskbCaSZxQeDP7K5xSYxgF5vxYXdFTbSyi73_FvwYo8h_8E3F7A=w2400",
    "building1": "https://lh3.googleusercontent.com/wqZgTUZvoicrqWWfVWpNxu2A0jpxw9hx-tGo264pRw1Myr0sxjuzC20F8WgefP590-LmfsKBapCaH43vnqxSv9AG1zgvwKoUriI4O-eUTPHv7jT-CrZWMxT8n9Ws9tRWzgtqryRbTg=w2400",
    "airport": "https://lh3.googleusercontent.com/HkhIhH2TYtPlmlsj13HusTlJuCVHcEP6h3-XzaFUKc-ImOdvP6meFiikS4gej6bNY9PuC-2tHfHW5l_teQ8A96vLdEXq9yWXHolXFmbWRm1PCYNkSrO9ggtsmCIcRj58p-7gvfUdcg=w2400",
    "skydome": "https://lh3.googleusercontent.com/ItqOj3fgRuMy7xeTVvOUyifyWxTnm2LyOnWJcN8OAzoRpxZwgi-tAPids9pS4RjOb3Q1Hb1YxY6yQBUesH0yGEFVZIG8A3jzgjpeCxpmn39cflO6B7Hyp_oD_kPxdOLaS4ZFTPr51A=w2400",
    "building3": "https://lh3.googleusercontent.com/yEYkoiOrRKj1xwGZjs7TCE0mTVGSzUwU12goqO9hlIVYURXjy1VjlrOx_YGaS7_ZcSw86Kdr7Bo8b0giCOI-MZDIAu8TEkDgcTVIMlZ0cIYYAMs8b5DxC2UFt0qzGCx8p05Hhzi6NA=w2400",
    "building2": "https://lh3.googleusercontent.com/qnLioDbD9T-ZPBUg3IB-l5B4G7DYTFPDGD9DXRwcfbXFN5vmmeYknIDycpV6aRyRIojwU_HtHRGz_QnxDSpMFC8ix2vyo09U67ce5NAXnrbB8qFWwqSylejeK-kIFTeFkPimRHPtog=w2400",
    "farm": "https://lh3.googleusercontent.com/vZNoB1ExSw-dpVUT49KBumLpJ5o67THnAbWZ0KlpEzGaaHrhCRi0EPNBy638gjfpsqlgaHsR-UN7-UMMVMGWIndTZSjqlRlMwJZCOXU4pksqJIi_bGP7bkRiEyizsyKyDsymyjp90g=w2400",
    "government": "https://lh3.googleusercontent.com/gw2poqCEVK4e1HgVE2FuachCL0b1Zc88n87CHJmiV9ocbBSEVogYSzdar7PG-Ct3HFMQuCLDrbnLRoWJmZAe6WUjRqlb2XZ9O9pIz5xaZybhV09kES8ksJwYOErmGrNk8OATQl0FeA=w2400",
    "here": "https://lh3.googleusercontent.com/MWhy9TSElYhmacHrCsaz7Mwviqj2Aou-3Aei0bAJQ_JEf0KIPp9p90jJcTda7VWe_UMdKTWg-aJhANV8hEmYPziiN2a_zWiKmt_Qy017MxCVzkAPmSK40VPo_iHsC94XsG30cyQkDA=w2400",
    "military": "https://lh3.googleusercontent.com/YGyMxrS7CR8UZ7onmjsIjaykJuEcNyKHXDLu5RlFlhz2qAqb0tVrl8yynwmkj2NiYsChpFMA9fTgy7Yrv279MqiZVqeCMhvG3vYbKLninnIUk8sakah87ko4FrHtj5r63YcZa_l02w=w2400",
    "mine": "https://lh3.googleusercontent.com/Uj6euP3Zmjl0fzb7NG-Sk50spwgfzJe0sds_OrBBu6ifpMB98FtfRbHpzYposnw27_H1d9Kk_bUjsvD0d9NQAh70B7XJw2pm7VcVbIg4fXNX1Z24BMyPWB5Ybfe2jgPb-2QFnG5ezw=w2400",
    "observatory": "https://lh3.googleusercontent.com/yC-tHmkrpd1X0NXo6Nm34ONCpFH_O1Lwv_9Iji08Spbead51RJVGmSwPxRgNeXB5FAf5N-7RTHq-i2G0d37uVdh-QcVCKowdzUQJ4wbyU7fy35-SOwwmiCCyCFaLOUehyLKtpmsA3Q=s40-p-k",
    "radio": "https://lh3.googleusercontent.com/r-qyqv_YItsIHNFaxeatoRODjy21l5WxIJ-llW86YUPr-iJBD87pck1q50PGf0RDS-uy0DX0itajp3tRX-P01ybvae0MlANSypuKFN-T9nw9Gav7WRGrqcm5A7cmP4hoY9OZXd4hDg=w2400",
    "restaurant": "https://lh3.googleusercontent.com/Myb7JBL2p14TWNGvYNJtdTftPu5pYfazevoJdZWb_4ANRH6OgX-fetCTYHef2jV8T17eQRF4-l9rDYQDn5sDjnXhLzXuDfHuJ6ZPA1u-O-NcXl26o13LJie2JdsVFv7uSifLJ67YoA=w2400",
    "vault": "https://lh3.googleusercontent.com/TIwZkQeoFLPVnMeYoKkDjSVxWr1-lWogxuTyQHkCZsEdTEoOoXZFRY_0YK0caqbpTAdZ7er3XSDyZGQXw5qSty-fj4dH8Fv_fChNaYJnoHYSImFPixjru1AtGyWmJD9KnYoLmtCK6Q=w2400",
    "blank" : "https://lh3.googleusercontent.com/NVxr2rxUTODB6H4T0NDasE15KV1e-rXINBzoAf0l9AE1_MS72yZDPSahWBe32L_mZBVX6yhB2itH6B4ZCyr8cY7DtYRXSNu0E5c5I2VzY8G8IYUStc2thmZ-Xck7k8gN7W92X5qjNw=s1-p-k"
}

//main map function
async function buildGoogleAPI(location) {
    googlestart = "https://maps.googleapis.com/maps/api/geocode/json?address=";
    var address = location.address;
    var k = "&key="
    var key = "AIzaSyBGqQuAH6MEcprMsMH5CayhlcXda1ohDHc";
    geolocation = googlestart.concat(address, k, key);
    return geolocation
}

async function checkLocation2(geolocation) {
    let results;
    var res = await fetch(geolocation)
    json = await res.json();
    if (json.status == 'ZERO_RESULTS') return {lat: 0, lng: 0}
    results = await json.results[0].geometry.location
    return results
}

async function markerAndText(iconValue, coordinates, placeName, map) {
    const marker2 = await new google.maps.Marker({ //and make them a marker
        icon: iconValue,
        position: { lat: coordinates.lat, lng: coordinates.lng },
        map: map,
        label: {
            text: placeName,
            color: '05f71e',
            fontSize: '20px',
            fontWeight: 'bold',
        }
    });
}


// Initialize and add the map
async function initMap() {
    // Set up map at Ronto
    const ronto = { lat: 43.652, lng: -79.3832 };
    const map = new google.maps.Map(document.getElementById("map"), {
        mapId: "acfe604f1d6e7b3c",
        zoom: 12,
        center: ronto,
    });

    // // Marker positions - sveral locations
    for (let i = 0; i < location_list_json.length; i++) {
        geolocation = await buildGoogleAPI(location_list_json[i]);
        iconKey = await String(location_list_json[i].icon);
        iconValue = await mapIcons[iconKey]
        coordinates = await checkLocation2(geolocation); // get coordinates
        placeName = await String(location_list_json[i].locationName)
        markerAndText(iconValue, coordinates, ".", map)
        textCoord = { lat: coordinates.lat - 0.0001, lng: coordinates.lng }
        markerAndText(mapIcons['blank'], textCoord, placeName, map)
    }
}

window.initMap = initMap;